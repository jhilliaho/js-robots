<!DOCTYPE html>
<html>
  <head>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
	<script src="https://code.highcharts.com/highcharts.js"></script>
	<script src="https://code.highcharts.com/modules/exporting.js"></script>
	<script src="http://46.101.79.118:3000/static/javascripts/socket.io-1.4.5.js"></script>
  </head>
  <body>

<div id="container" style="min-width: 310px; height: 800px; margin: 0 auto"></div>

... 

  </body>
</html>

<script>

var dataCount = 0;

$('#container').highcharts({
    title: {
        text: 'Huoneen lämpötila ja ilmankosteus',
        x: -20 //center
    },

    chart: {
        type: 'spline',
  		zoomType: 'x',
        panning: true,
        panKey: 'shift'
   	},
    legend: {
        layout: 'vertical',
        align: 'right',
        verticalAlign: 'middle',
        borderWidth: 0
    },
    series: [{
        name: 'Temperature (C)',
        data: []
    }, {
        name: 'Humidity (%)',
        data: []
    }],

});

var socket = io('http://46.101.79.118:3000');
socket.emit('getData');

$('#container').highcharts().showLoading("Wait a second");

socket.on('allData', function (data) {
	console.log("GOT DATA:", data);

	for (var i = 0; i < data.length; ++i) {
		$('#container').highcharts().xAxis[0].series[0].addPoint([data[i].date, data[i].temperature], false);
		$('#container').highcharts().xAxis[0].series[1].addPoint([data[i].date, data[i].humidity], false);
		dataCount++;
	}

	$('#container').highcharts().redraw();
	$('#container').highcharts().hideLoading();
});

socket.on('newData', function (data) {
	console.log("GOT DATA:", data);

	$('#container').highcharts().xAxis[0].series[0].addPoint([data.date, data.temperature], false);
	$('#container').highcharts().xAxis[0].series[1].addPoint([data.date, data.humidity], false);
	$('#container').highcharts().redraw();
	dataCount++;
});
</script>

